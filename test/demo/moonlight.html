<html>
<head>
<script src="../../musical.js"></script> <!-- defines Instrument class -->
</head>

<body style="font-family:Arial;padding:36px 20%;">
<h2>The Moonlight Sonata. <span></span></h2>

<p>This web page is a demonstration of the use of musical.js
with a plain script tag.  Here is the code for this page:</p>

<pre style="background:skyblue"></pre>

<script>

// Select a timbre that sounds like a piano.
var inst = new Instrument('piano');

// The song below is written in ABC notation.  More on abc
// notation can be found at http://abcnotation.com/.
var song =
  "X: 1\n" +
  "T:Beethoven's Moonlight Sonata, transcribed into ABC by David Bau.\n" +
  "M:4/4\n" +
  "L:1/8\n" +
  "R:\n" +
  "K:C#m\n" +
  "[V:0]z8|\n" +
  "[V:1](3G,CE)(3G,CE)(3G,CE)(3G,CE)|\n" +
  "[V:2][C,,C,]8|\n" +
  "[V:0]z8|\n" +
  "[V:1](3G,CE)(3G,CE)(3G,CE)(3G,CE)|\n" +
  "[V:2][B,,,B,,]8|\n" +
  "[V:0]z8|\n" +
  "[V:1](3A,CE)(3A,CE)(3A,=DF)(3A,DF)|\n" +
  "[V:2][A,,,A,,]4[F,,F,,,]4|\n" +
  "[V:0]z8|\n" +
  "[V:1](3G,^B,F)(3G,CE)(3G,CD)(3F,B,D)|\n" +
  "[V:2][G,,,G,,]4[G,,G,,,]4|\n" +
  "[V:0]z6G>G|\n" +
  "[V:1](3E,G,C)(3G,CE)(3G,CE)(3G,CE)|\n" +
  "[V:2][C,,G,,C,]8|\n" +
  "[V:0]G6 G>G|\n" +
  "[V:1](3G,DF)(3G,DF)(3G,DF)(3G,DF)|\n" +
  "[V:2][^B,,,G,,^B,,]8|\n";

// Play a song from a string in ABC notation.
inst.play(song,
  // The optional second argument is a callback when the song is done.
  function() {
    document.getElementsByTagName('span')[0].innerHTML = '(Done playing.)';
  }
);

var pressed = {};
// Optional, just for fun: listen to every note played.
inst.on('noteon', function(e) {
  pressed[e.midi] = true;
  drawMidiNumbers();
});
// And listen to every note released.
inst.on('noteoff', function(e) {
  delete pressed[e.midi];
  drawMidiNumbers();
});
function drawMidiNumbers() {
  var k = [];
  for (var midi in pressed) { k.push(midi); }
  document.getElementsByTagName('span')[0].innerHTML =
    '(midi #' + k.join(',') +')';
}


</script>

<p>Minified, musical.js is about 17K, and it has no dependencies.
It can also be used as an AMD or node.js modele.

<script>
// Also, show this document's source code.
var pre = document.getElementsByTagName('pre')[0];
pre.innerText = document.body.parentElement.outerHTML;
pre.innerHTML = pre.innerHTML.replace(
    /(new Instrument|\/musical\.js|\.play)(?![|\)])/gi,
    '<b style="background:yellow">$1</b>');
</script>

</body>
</html>
